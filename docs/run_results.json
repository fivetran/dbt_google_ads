{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.3", "generated_at": "2023-12-12T20:41:58.613964Z", "invocation_id": "597857d4-3431-44ea-a435-be88ce0a348f", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.392836Z", "completed_at": "2023-12-12T20:41:57.420524Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.422201Z", "completed_at": "2023-12-12T20:41:57.422215Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0329899787902832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__account_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"google_ads_integration_tests_31\".\"account_history_data\"", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.412109Z", "completed_at": "2023-12-12T20:41:57.420854Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.422937Z", "completed_at": "2023-12-12T20:41:57.422940Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0332181453704834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__account_stats_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"google_ads_integration_tests_31\".\"account_stats_data\"", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_stats_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.415216Z", "completed_at": "2023-12-12T20:41:57.421358Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.423774Z", "completed_at": "2023-12-12T20:41:57.423777Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.033484697341918945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_criterion_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"google_ads_integration_tests_31\".\"ad_group_criterion_history_data\"", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_criterion_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.417754Z", "completed_at": "2023-12-12T20:41:57.421689Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.424054Z", "completed_at": "2023-12-12T20:41:57.424058Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.03366899490356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"google_ads_integration_tests_31\".\"ad_group_history_data\"", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.432574Z", "completed_at": "2023-12-12T20:41:57.441377Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.441911Z", "completed_at": "2023-12-12T20:41:57.441916Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01500701904296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"google_ads_integration_tests_31\".\"ad_history_data\"", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.429077Z", "completed_at": "2023-12-12T20:41:57.442168Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.444392Z", "completed_at": "2023-12-12T20:41:57.444396Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01908707618713379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_stats_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"google_ads_integration_tests_31\".\"ad_group_stats_data\"", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_stats_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.435310Z", "completed_at": "2023-12-12T20:41:57.442966Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.445261Z", "completed_at": "2023-12-12T20:41:57.445265Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018423795700073242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_stats_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"google_ads_integration_tests_31\".\"ad_stats_data\"", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_stats_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.438604Z", "completed_at": "2023-12-12T20:41:57.443483Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.445977Z", "completed_at": "2023-12-12T20:41:57.445980Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01885199546813965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__campaign_history_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"google_ads_integration_tests_31\".\"campaign_history_data\"", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_history_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.447685Z", "completed_at": "2023-12-12T20:41:57.452115Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.457327Z", "completed_at": "2023-12-12T20:41:57.457332Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01462411880493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__campaign_stats_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"google_ads_integration_tests_31\".\"campaign_stats_data\"", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_stats_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.456013Z", "completed_at": "2023-12-12T20:41:57.456995Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.460037Z", "completed_at": "2023-12-12T20:41:57.460040Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009860038757324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_integration_tests.account_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.457614Z", "completed_at": "2023-12-12T20:41:57.458520Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.460916Z", "completed_at": "2023-12-12T20:41:57.460920Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.010129928588867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_integration_tests.account_stats_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.452935Z", "completed_at": "2023-12-12T20:41:57.459033Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.461704Z", "completed_at": "2023-12-12T20:41:57.461707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012552022933959961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__keyword_stats_tmp", "compiled": true, "compiled_code": "\n\n\n    \n    \n        \n        \n        \n        select * \n    from \"postgres\".\"google_ads_integration_tests_31\".\"keyword_stats_data\"", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__keyword_stats_tmp\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.464828Z", "completed_at": "2023-12-12T20:41:57.466684Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.469839Z", "completed_at": "2023-12-12T20:41:57.469843Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010836124420166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_integration_tests.ad_group_criterion_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.468396Z", "completed_at": "2023-12-12T20:41:57.469334Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.473328Z", "completed_at": "2023-12-12T20:41:57.473331Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01032400131225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_integration_tests.ad_group_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.470118Z", "completed_at": "2023-12-12T20:41:57.471014Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.474021Z", "completed_at": "2023-12-12T20:41:57.474023Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.008523225784301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_integration_tests.ad_group_stats_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.471508Z", "completed_at": "2023-12-12T20:41:57.472372Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.474782Z", "completed_at": "2023-12-12T20:41:57.474785Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008688926696777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_integration_tests.ad_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.477702Z", "completed_at": "2023-12-12T20:41:57.478696Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.481754Z", "completed_at": "2023-12-12T20:41:57.481758Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010415077209472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_integration_tests.ad_stats_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.480315Z", "completed_at": "2023-12-12T20:41:57.481259Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.485976Z", "completed_at": "2023-12-12T20:41:57.485979Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010016918182373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_integration_tests.campaign_history_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.482001Z", "completed_at": "2023-12-12T20:41:57.483620Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.486683Z", "completed_at": "2023-12-12T20:41:57.486686Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.009277820587158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_integration_tests.campaign_stats_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.484142Z", "completed_at": "2023-12-12T20:41:57.485002Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.487492Z", "completed_at": "2023-12-12T20:41:57.487495Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009469032287597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.google_ads_integration_tests.keyword_stats_data", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.533153Z", "completed_at": "2023-12-12T20:41:57.834172Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.845002Z", "completed_at": "2023-12-12T20:41:57.845010Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3768768310546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_criterion_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_criterion_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    base_campaign_id\n    \n as \n    \n    base_campaign_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    keyword_match_type\n    \n as \n    \n    keyword_match_type\n    \n, \n    \n    \n    keyword_text\n    \n as \n    \n    keyword_text\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n \n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as criterion_id,\n        cast(ad_group_id as TEXT) as ad_group_id,\n        base_campaign_id,\n        updated_at,\n        type,\n        status,\n        keyword_match_type,\n        keyword_text,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_most_recent_record\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_criterion_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.490409Z", "completed_at": "2023-12-12T20:41:57.845277Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.847196Z", "completed_at": "2023-12-12T20:41:57.847201Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.39382410049438477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__account_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    auto_tagging_enabled\n    \n as \n    \n    auto_tagging_enabled\n    \n, \n    \n    \n    currency_code\n    \n as \n    \n    currency_code\n    \n, \n    \n    \n    descriptive_name\n    \n as \n    \n    descriptive_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    time_zone\n    \n as \n    \n    time_zone\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as account_id,\n        updated_at,\n        currency_code,\n        auto_tagging_enabled,\n        time_zone,\n        descriptive_name as account_name,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_most_recent_record\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.497829Z", "completed_at": "2023-12-12T20:41:57.846095Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.847727Z", "completed_at": "2023-12-12T20:41:57.847729Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.39226603507995605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__account_stats", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_stats_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_network_type\n    \n as \n    \n    ad_network_type\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_micros\n    \n as \n    \n    cost_micros\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        customer_id as account_id, \n        date as date_day,\n        ad_network_type,\n        device,\n        clicks, \n        cost_micros / 1000000.0 as spend, \n        impressions\n        \n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_stats\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.537408Z", "completed_at": "2023-12-12T20:41:57.844640Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:57.846652Z", "completed_at": "2023-12-12T20:41:57.846656Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.38553905487060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_history_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    campaign_name\n    \n as \n    \n    campaign_name\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(id as TEXT) as ad_group_id,\n        updated_at,\n        type as ad_group_type, \n        campaign_id, \n        campaign_name, \n        name as ad_group_name, \n        status as ad_group_status,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_most_recent_record\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.874455Z", "completed_at": "2023-12-12T20:41:58.168625Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.169183Z", "completed_at": "2023-12-12T20:41:58.169189Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3353300094604492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_history_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    display_url\n    \n as \n    \n    display_url\n    \n, \n    \n    \n    final_urls\n    \n as \n    \n    final_urls\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    type\n    \n as \n    \n    type\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        cast(ad_group_id as TEXT) as ad_group_id, \n        id as ad_id,\n        name as ad_name,\n        updated_at,\n        type as ad_type,\n        status as ad_status,\n        display_url,\n        final_urls as source_final_urls,\n        replace(replace(final_urls, '[', ''),']','') as final_urls,\n        row_number() over (partition by source_relation, id, ad_group_id order by updated_at desc) = 1 as is_most_recent_record\n    from fields\n    where coalesce(_fivetran_active, true)\n),\n\nfinal_urls as (\n\n    select \n        *,\n        --Extract the first url within the list of urls provided within the final_urls field\n        \n\n  \n    \n\n    split_part(\n        final_urls,\n        ',',\n        1\n        )\n\n\n  \n\n as final_url\n\n    from final\n\n),\n\nurl_fields as (\n    select \n        *,\n        \n\n  \n    \n\n    split_part(\n        final_url,\n        '?',\n        1\n        )\n\n\n  \n\n as base_url,\n        \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        \n\n    replace(\n        \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'android-app://',\n        ''\n    )\n\n\n,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        '/',\n        1\n        )\n\n\n  \n\n,\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_host,\n        '/' || \n    \n    cast(\n\n  \n    \n\n    split_part(\n        \n\n    right(\n        \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n,\n        \n\n    length(\n        \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    )-coalesce(\n            nullif(\n\n    position(\n        '/' in \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ), 0),\n            \n\n    position(\n        '?' in \n\n    replace(\n        \n\n    replace(\n        final_url,\n        'http://',\n        ''\n    )\n\n\n,\n        'https://',\n        ''\n    )\n\n\n\n    ) - 1\n            )\n    ),\n        '?',\n        1\n        )\n\n\n  \n\n as TEXT)\n as url_path,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        final_url,\n        'utm_source=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_source,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        final_url,\n        'utm_medium=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_medium,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        final_url,\n        'utm_campaign=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_campaign,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        final_url,\n        'utm_content=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_content,\n        nullif(\n\n  \n    \n\n    split_part(\n        \n\n  \n    \n\n    split_part(\n        final_url,\n        'utm_term=',\n        2\n        )\n\n\n  \n\n,\n        '&',\n        1\n        )\n\n\n  \n\n,'') as utm_term\n    from final_urls\n)\n\nselect * \nfrom url_fields", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.894474Z", "completed_at": "2023-12-12T20:41:58.183652Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.184181Z", "completed_at": "2023-12-12T20:41:58.184185Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.33275699615478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__campaign_history", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_history_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    advertising_channel_subtype\n    \n as \n    \n    advertising_channel_subtype\n    \n, \n    \n    \n    advertising_channel_type\n    \n as \n    \n    advertising_channel_type\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    end_date\n    \n as \n    \n    end_date\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    name\n    \n as \n    \n    name\n    \n, \n    \n    \n    serving_status\n    \n as \n    \n    serving_status\n    \n, \n    \n    \n    start_date\n    \n as \n    \n    start_date\n    \n, \n    \n    \n    status\n    \n as \n    \n    status\n    \n, \n    \n    \n    tracking_url_template\n    \n as \n    \n    tracking_url_template\n    \n, \n    \n    \n    updated_at\n    \n as \n    \n    updated_at\n    \n, \n    cast(null as boolean) as \n    \n    _fivetran_active\n    \n \n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        id as campaign_id, \n        updated_at,\n        name as campaign_name,\n        customer_id as account_id,\n        advertising_channel_type,\n        advertising_channel_subtype,\n        start_date,\n        end_date,\n        serving_status,\n        status,\n        tracking_url_template,\n        row_number() over (partition by source_relation, id order by updated_at desc) = 1 as is_most_recent_record\n    from fields\n    where coalesce(_fivetran_active, true)\n)\n\nselect * \nfrom final", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.890036Z", "completed_at": "2023-12-12T20:41:58.215509Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.217937Z", "completed_at": "2023-12-12T20:41:58.217941Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3627629280090332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_stats", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_stats_tmp\"\n\n),\n\nfields as (\n\n    select\n        \n    \n    \n    ad_group\n    \n as \n    \n    ad_group\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_id\n    \n as \n    \n    ad_id\n    \n, \n    \n    \n    ad_network_type\n    \n as \n    \n    ad_network_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_micros\n    \n as \n    \n    cost_micros\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n, \n    \n    \n    keyword_ad_group_criterion\n    \n as \n    \n    keyword_ad_group_criterion\n    \n\n\n\n        \n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        customer_id as account_id, \n        date as date_day, \n        \n        coalesce(cast(ad_group_id as TEXT), \n\n  \n    \n\n    split_part(\n        ad_group,\n        'adGroups/',\n        2\n        )\n\n\n  \n\n) as ad_group_id,\n        \n        keyword_ad_group_criterion,\n        ad_network_type,\n        device,\n        ad_id, \n        campaign_id, \n        clicks, \n        cost_micros / 1000000.0 as spend, \n        impressions\n        \n        \n\n\n\n\n\n    from fields\n)\n\nselect * from final", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_stats\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:57.885615Z", "completed_at": "2023-12-12T20:41:58.216076Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.218228Z", "completed_at": "2023-12-12T20:41:58.218231Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.370805025100708, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__ad_group_stats", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_stats_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_network_type\n    \n as \n    \n    ad_network_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_micros\n    \n as \n    \n    cost_micros\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation,\n        customer_id as account_id, \n        date as date_day, \n        cast(id as TEXT) as ad_group_id, \n        campaign_id, \n        device,\n        ad_network_type,\n        clicks, \n        cost_micros / 1000000.0 as spend, \n        impressions\n        \n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_stats\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.248287Z", "completed_at": "2023-12-12T20:41:58.263194Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.263780Z", "completed_at": "2023-12-12T20:41:58.263786Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.01654195785522461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__ad_group_criterion_history_source_relation__criterion_id__ad_group_id__updated_at.8d37dd2fa0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, criterion_id, ad_group_id, updated_at\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_criterion_history\"\n    group by source_relation, criterion_id, ad_group_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.258031Z", "completed_at": "2023-12-12T20:41:58.264834Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.266161Z", "completed_at": "2023-12-12T20:41:58.266166Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013075828552246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_group_criterion_history_criterion_id.7a0a8b8476", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect criterion_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_criterion_history\"\nwhere criterion_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.266421Z", "completed_at": "2023-12-12T20:41:58.271954Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.275590Z", "completed_at": "2023-12-12T20:41:58.275598Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.010991096496582031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__account_history_source_relation__account_id__updated_at.0a4d931c44", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, updated_at\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history\"\n    group by source_relation, account_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.272289Z", "completed_at": "2023-12-12T20:41:58.282971Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.285091Z", "completed_at": "2023-12-12T20:41:58.285096Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014250040054321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__account_history_account_id.5ca373f51f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.277566Z", "completed_at": "2023-12-12T20:41:58.286248Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.287507Z", "completed_at": "2023-12-12T20:41:58.287511Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.014635086059570312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads.google_ads__account_report", "compiled": true, "compiled_code": "\n\nwith stats as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_stats\"\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history\"\n    where is_most_recent_record = True\n), \n\nfields as (\n\n    select\n        stats.source_relation,\n        stats.date_day,\n        accounts.account_name,\n        stats.account_id,\n        accounts.currency_code,\n        accounts.auto_tagging_enabled,\n        accounts.time_zone,\n        sum(stats.spend) as spend,\n        sum(stats.clicks) as clicks,\n        sum(stats.impressions) as impressions\n\n        \n\n\n\n\n\n    from stats\n    left join accounts\n        on stats.account_id = accounts.account_id\n        and stats.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__account_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.287780Z", "completed_at": "2023-12-12T20:41:58.295552Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.296153Z", "completed_at": "2023-12-12T20:41:58.296157Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010046958923339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__account_stats_source_relation__account_id__device__ad_network_type__date_day.7d4d5e9ce2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, device, ad_network_type, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_stats\"\n    group by source_relation, account_id, device, ad_network_type, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.292939Z", "completed_at": "2023-12-12T20:41:58.296892Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.298255Z", "completed_at": "2023-12-12T20:41:58.298259Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.006695985794067383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__account_stats_account_id.2a9da5417b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_stats\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.299308Z", "completed_at": "2023-12-12T20:41:58.306998Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.307571Z", "completed_at": "2023-12-12T20:41:58.307575Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010183095932006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__account_stats_date_day.57ac8772d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_stats\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.303941Z", "completed_at": "2023-12-12T20:41:58.308314Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.309535Z", "completed_at": "2023-12-12T20:41:58.309538Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0069239139556884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__ad_group_history_source_relation__ad_group_id__updated_at.94eb3f93a4", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, updated_at\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_history\"\n    group by source_relation, ad_group_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.310495Z", "completed_at": "2023-12-12T20:41:58.317025Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.317600Z", "completed_at": "2023-12-12T20:41:58.317605Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008860111236572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_group_history_ad_group_id.f6c7c939be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_history\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.314092Z", "completed_at": "2023-12-12T20:41:58.318341Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.319535Z", "completed_at": "2023-12-12T20:41:58.319539Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0067501068115234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__ad_history_source_relation__ad_id__ad_group_id__updated_at.edca86664e", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, ad_group_id, updated_at\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_history\"\n    group by source_relation, ad_id, ad_group_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.320532Z", "completed_at": "2023-12-12T20:41:58.327839Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.328419Z", "completed_at": "2023-12-12T20:41:58.328423Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009704113006591797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_history_ad_id.8c23c38248", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_history\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.324211Z", "completed_at": "2023-12-12T20:41:58.329166Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.330349Z", "completed_at": "2023-12-12T20:41:58.330353Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007439851760864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__campaign_history_source_relation__campaign_id__updated_at.008fea6b77", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, updated_at\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_history\"\n    group by source_relation, campaign_id, updated_at\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.331343Z", "completed_at": "2023-12-12T20:41:58.339924Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.340463Z", "completed_at": "2023-12-12T20:41:58.340468Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011178016662597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__campaign_history_campaign_id.fa0c825e75", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_history\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.334912Z", "completed_at": "2023-12-12T20:41:58.340729Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.341997Z", "completed_at": "2023-12-12T20:41:58.342000Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.008477210998535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads.google_ads__ad_report", "compiled": true, "compiled_code": "\n\nwith stats as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_stats\"\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history\"\n    where is_most_recent_record = True\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_history\"\n    where is_most_recent_record = True\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_history\"\n    where is_most_recent_record = True\n),\n\nads as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_history\"\n    where is_most_recent_record = True\n), \n\nfields as (\n\n    select\n        stats.source_relation,\n        stats.date_day,\n        accounts.account_name,\n        accounts.account_id,\n        accounts.currency_code,\n        campaigns.campaign_name,\n        campaigns.campaign_id,\n        ad_groups.ad_group_name,\n        stats.ad_group_id,\n        stats.ad_id,\n        ads.ad_name,\n        ads.ad_status,\n        ads.ad_type,\n        ads.display_url,\n        ads.source_final_urls,\n        sum(stats.spend) as spend,\n        sum(stats.clicks) as clicks,\n        sum(stats.impressions) as impressions\n\n        \n\n\n\n\n\n    from stats\n    left join ads\n        on stats.ad_id = ads.ad_id\n        and stats.source_relation = ads.source_relation\n        and stats.ad_group_id = ads.ad_group_id\n    left join ad_groups\n        on ads.ad_group_id = ad_groups.ad_group_id\n        and ads.source_relation = ad_groups.source_relation\n    left join campaigns\n        on ad_groups.campaign_id = campaigns.campaign_id\n        and ad_groups.source_relation = campaigns.source_relation\n    left join accounts\n        on campaigns.account_id = accounts.account_id\n        and campaigns.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__ad_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.343663Z", "completed_at": "2023-12-12T20:41:58.353308Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.353819Z", "completed_at": "2023-12-12T20:41:58.353823Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0122528076171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads.google_ads__url_report", "compiled": true, "compiled_code": "\n\nwith stats as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_stats\"\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history\"\n    where is_most_recent_record = True\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_history\"\n    where is_most_recent_record = True\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_history\"\n    where is_most_recent_record = True\n),\n\nads as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_history\"\n    where is_most_recent_record = True\n), \n\nfields as (\n\n    select\n        stats.source_relation,\n        stats.date_day,\n        accounts.account_name,\n        accounts.account_id,\n        accounts.currency_code,\n        campaigns.campaign_name,\n        campaigns.campaign_id,\n        ad_groups.ad_group_name,\n        stats.ad_group_id,\n        stats.ad_id,\n        ads.base_url,\n        ads.url_host,\n        ads.url_path,\n\n        \n\n        ads.utm_source,\n        ads.utm_medium,\n        ads.utm_campaign,\n        ads.utm_content,\n        \n        \n\n        ads.utm_term,\n        sum(stats.spend) as spend,\n        sum(stats.clicks) as clicks,\n        sum(stats.impressions) as impressions\n\n        \n\n\n\n\n\n    from stats\n    left join ads\n        on stats.ad_id = ads.ad_id\n        and stats.source_relation = ads.source_relation\n        and stats.ad_group_id = ads.ad_group_id\n    left join ad_groups\n        on ads.ad_group_id = ad_groups.ad_group_id\n        and ads.source_relation = ad_groups.source_relation\n    left join campaigns\n        on ad_groups.campaign_id = campaigns.campaign_id\n        and ad_groups.source_relation = campaigns.source_relation\n    left join accounts\n        on campaigns.account_id = accounts.account_id\n        and campaigns.source_relation = accounts.source_relation\n\n    \n        where ads.source_final_urls is not null\n    \n\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__url_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.350096Z", "completed_at": "2023-12-12T20:41:58.354051Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.355435Z", "completed_at": "2023-12-12T20:41:58.355439Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0068700313568115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__ad_stats_source_relation__ad_id__ad_network_type__device__ad_group_id__keyword_ad_group_criterion__date_day.222a7d9413", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, ad_network_type, device, ad_group_id, keyword_ad_group_criterion, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_stats\"\n    group by source_relation, ad_id, ad_network_type, device, ad_group_id, keyword_ad_group_criterion, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.357101Z", "completed_at": "2023-12-12T20:41:58.363634Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.364173Z", "completed_at": "2023-12-12T20:41:58.364177Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009082794189453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_stats_ad_id.2612d83cc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_stats\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.361160Z", "completed_at": "2023-12-12T20:41:58.364421Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.365566Z", "completed_at": "2023-12-12T20:41:58.365569Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.005956172943115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_stats_date_day.9a43c0fce4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_stats\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.367301Z", "completed_at": "2023-12-12T20:41:58.375221Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.375747Z", "completed_at": "2023-12-12T20:41:58.375752Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010310173034667969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads.google_ads__ad_group_report", "compiled": true, "compiled_code": "\n\nwith stats as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_stats\"\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history\"\n    where is_most_recent_record = True\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_history\"\n    where is_most_recent_record = True\n),\n\nad_groups as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_history\"\n    where is_most_recent_record = True\n), \n\nfields as (\n\n    select\n        stats.source_relation,\n        stats.date_day,\n        accounts.account_name,\n        accounts.account_id,\n        accounts.currency_code,\n        campaigns.campaign_name,\n        campaigns.campaign_id,\n        ad_groups.ad_group_name,\n        stats.ad_group_id,\n        ad_groups.ad_group_status,\n        ad_groups.ad_group_type,\n        sum(stats.spend) as spend,\n        sum(stats.clicks) as clicks,\n        sum(stats.impressions) as impressions\n\n        \n\n\n\n\n\n    from stats\n    left join ad_groups\n        on stats.ad_group_id = ad_groups.ad_group_id\n        and stats.source_relation = ad_groups.source_relation\n    left join campaigns\n        on ad_groups.campaign_id = campaigns.campaign_id\n        and ad_groups.source_relation = campaigns.source_relation\n    left join accounts\n        on campaigns.account_id = accounts.account_id\n        and campaigns.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__ad_group_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.372499Z", "completed_at": "2023-12-12T20:41:58.380062Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.380623Z", "completed_at": "2023-12-12T20:41:58.380627Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009288311004638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__ad_group_stats_source_relation__ad_group_id__device__ad_network_type__date_day.0755df524f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, device, ad_network_type, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_stats\"\n    group by source_relation, ad_group_id, device, ad_network_type, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.377303Z", "completed_at": "2023-12-12T20:41:58.381402Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.382523Z", "completed_at": "2023-12-12T20:41:58.382526Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006426095962524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_group_stats_ad_group_id.a8d430f077", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_stats\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.383507Z", "completed_at": "2023-12-12T20:41:58.390662Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.391191Z", "completed_at": "2023-12-12T20:41:58.391196Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009491920471191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__ad_group_stats_date_day.3c6a221786", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_stats\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.387992Z", "completed_at": "2023-12-12T20:41:58.395556Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.396084Z", "completed_at": "2023-12-12T20:41:58.396088Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009166240692138672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.dbt_utils_unique_combination_of_columns_google_ads__account_report_source_relation__account_id__date_day.8480aa9317", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, account_id, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__account_report\"\n    group by source_relation, account_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.392984Z", "completed_at": "2023-12-12T20:41:58.397129Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.398230Z", "completed_at": "2023-12-12T20:41:58.398233Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.009031057357788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.not_null_google_ads__account_report_account_id.abb0985422", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__account_report\"\nwhere account_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.398494Z", "completed_at": "2023-12-12T20:41:58.405252Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.406051Z", "completed_at": "2023-12-12T20:41:58.406057Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009446144104003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.dbt_utils_unique_combination_of_columns_google_ads__ad_report_source_relation__ad_id__ad_group_id__date_day.0e82f7e99a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, ad_group_id, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__ad_report\"\n    group by source_relation, ad_id, ad_group_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.402635Z", "completed_at": "2023-12-12T20:41:58.406393Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.407730Z", "completed_at": "2023-12-12T20:41:58.407733Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0064580440521240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.not_null_google_ads__ad_report_ad_id.7bd6a287ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__ad_report\"\nwhere ad_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.409326Z", "completed_at": "2023-12-12T20:41:58.416557Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.417127Z", "completed_at": "2023-12-12T20:41:58.417131Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009588003158569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.dbt_utils_unique_combination_of_columns_google_ads__url_report_source_relation__ad_id__ad_group_id__date_day.e11b928273", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_id, ad_group_id, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__url_report\"\n    group by source_relation, ad_id, ad_group_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.412890Z", "completed_at": "2023-12-12T20:41:58.417918Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.419118Z", "completed_at": "2023-12-12T20:41:58.419122Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.007570981979370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.not_null_google_ads__url_report_base_url.e3578c0f72", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_url\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__url_report\"\nwhere base_url is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.420077Z", "completed_at": "2023-12-12T20:41:58.426317Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.426908Z", "completed_at": "2023-12-12T20:41:58.426913Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008669853210449219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.dbt_utils_unique_combination_of_columns_google_ads__ad_group_report_source_relation__ad_group_id__date_day.41d73a32f3", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__ad_group_report\"\n    group by source_relation, ad_group_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.423782Z", "completed_at": "2023-12-12T20:41:58.427854Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.428406Z", "completed_at": "2023-12-12T20:41:58.428410Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0056798458099365234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.not_null_google_ads__ad_group_report_ad_group_id.c186523c0c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ad_group_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__ad_group_report\"\nwhere ad_group_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.220069Z", "completed_at": "2023-12-12T20:41:58.503659Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.504724Z", "completed_at": "2023-12-12T20:41:58.504730Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3145458698272705, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__keyword_stats", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__keyword_stats_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_group_criterion_criterion_id\n    \n as \n    \n    ad_group_criterion_criterion_id\n    \n, \n    \n    \n    ad_group_id\n    \n as \n    \n    ad_group_id\n    \n, \n    \n    \n    ad_network_type\n    \n as \n    \n    ad_network_type\n    \n, \n    \n    \n    campaign_id\n    \n as \n    \n    campaign_id\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_micros\n    \n as \n    \n    cost_micros\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        _fivetran_id as keyword_id,\n        customer_id as account_id, \n        date as date_day, \n        cast(ad_group_id as TEXT) as ad_group_id,\n        ad_group_criterion_criterion_id as criterion_id,\n        campaign_id, \n        clicks, \n        cost_micros / 1000000.0 as spend, \n        impressions\n        \n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__keyword_stats\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.210766Z", "completed_at": "2023-12-12T20:41:58.503944Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.504983Z", "completed_at": "2023-12-12T20:41:58.504986Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.32436609268188477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads_source.stg_google_ads__campaign_stats", "compiled": true, "compiled_code": "\n\nwith base as (\n\n    select * \n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_stats_tmp\"\n),\n\nfields as (\n\n    select\n        \n    \n    \n    _fivetran_id\n    \n as \n    \n    _fivetran_id\n    \n, \n    \n    \n    _fivetran_synced\n    \n as \n    \n    _fivetran_synced\n    \n, \n    \n    \n    ad_network_type\n    \n as \n    \n    ad_network_type\n    \n, \n    \n    \n    clicks\n    \n as \n    \n    clicks\n    \n, \n    \n    \n    cost_micros\n    \n as \n    \n    cost_micros\n    \n, \n    \n    \n    customer_id\n    \n as \n    \n    customer_id\n    \n, \n    \n    \n    date\n    \n as \n    \n    date\n    \n, \n    \n    \n    device\n    \n as \n    \n    device\n    \n, \n    \n    \n    id\n    \n as \n    \n    id\n    \n, \n    \n    \n    impressions\n    \n as \n    \n    impressions\n    \n\n\n\n    \n        \n\n\n, cast('' as TEXT) as source_relation\n\n\n\n\n    from base\n),\n\nfinal as (\n\n    select\n        source_relation, \n        customer_id as account_id, \n        date as date_day, \n        id as campaign_id, \n        ad_network_type,\n        device,\n        clicks, \n        cost_micros / 1000000.0 as spend, \n        impressions\n        \n        \n\n\n\n\n\n    from fields\n)\n\nselect *\nfrom final", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_stats\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.535846Z", "completed_at": "2023-12-12T20:41:58.544363Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.552439Z", "completed_at": "2023-12-12T20:41:58.552446Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.021055936813354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads.google_ads__keyword_report", "compiled": true, "compiled_code": "\n\nwith stats as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__keyword_stats\"\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history\"\n    where is_most_recent_record = True\n),\n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_history\"\n    where is_most_recent_record = True\n), \n\nad_groups as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_history\"\n    where is_most_recent_record = True\n), \n\ncriterions as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__ad_group_criterion_history\"\n    where is_most_recent_record = True\n), \n\nfields as (\n\n    select\n        stats.source_relation,\n        stats.date_day,\n        accounts.account_name,\n        stats.account_id,\n        accounts.currency_code,\n        campaigns.campaign_name,\n        stats.campaign_id,\n        ad_groups.ad_group_name,\n        stats.ad_group_id,\n        stats.criterion_id,\n        criterions.type,\n        criterions.status,\n        criterions.keyword_match_type,\n        criterions.keyword_text,\n        sum(stats.spend) as spend,\n        sum(stats.clicks) as clicks,\n        sum(stats.impressions) as impressions\n\n        \n\n\n\n\n\n    from stats\n    left join criterions\n        on stats.criterion_id = criterions.criterion_id\n        and stats.source_relation = criterions.source_relation\n    left join ad_groups\n        on stats.ad_group_id = ad_groups.ad_group_id\n        and stats.source_relation = ad_groups.source_relation\n    left join campaigns\n        on stats.campaign_id = campaigns.campaign_id\n        and stats.source_relation = campaigns.source_relation\n    left join accounts\n        on stats.account_id = accounts.account_id\n        and stats.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__keyword_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.545901Z", "completed_at": "2023-12-12T20:41:58.556846Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.559326Z", "completed_at": "2023-12-12T20:41:58.559331Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017039775848388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__keyword_stats_source_relation__keyword_id__date_day.4ecf84a32f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, keyword_id, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__keyword_stats\"\n    group by source_relation, keyword_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.549376Z", "completed_at": "2023-12-12T20:41:58.557180Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.559912Z", "completed_at": "2023-12-12T20:41:58.559915Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017375946044921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__keyword_stats_date_day.a9da72f74d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__keyword_stats\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.552805Z", "completed_at": "2023-12-12T20:41:58.558390Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.560952Z", "completed_at": "2023-12-12T20:41:58.560955Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.02223992347717285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__keyword_stats_keyword_id.f0945d6cf0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect keyword_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__keyword_stats\"\nwhere keyword_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.561710Z", "completed_at": "2023-12-12T20:41:58.568523Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.574086Z", "completed_at": "2023-12-12T20:41:58.574095Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.02299189567565918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.google_ads.google_ads__campaign_report", "compiled": true, "compiled_code": "\n\nwith stats as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_stats\"\n), \n\naccounts as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__account_history\"\n    where is_most_recent_record = True\n), \n\ncampaigns as (\n\n    select *\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_history\"\n    where is_most_recent_record = True\n), \n\nfields as (\n\n    select\n        stats.source_relation,\n        stats.date_day,\n        accounts.account_name,\n        accounts.account_id,\n        accounts.currency_code,\n        campaigns.campaign_name,\n        stats.campaign_id,\n        campaigns.advertising_channel_type,\n        campaigns.advertising_channel_subtype,\n        campaigns.status,\n        sum(stats.spend) as spend,\n        sum(stats.clicks) as clicks,\n        sum(stats.impressions) as impressions\n\n        \n\n\n\n\n\n    from stats\n    left join campaigns\n        on stats.campaign_id = campaigns.campaign_id\n        and stats.source_relation = campaigns.source_relation\n    left join accounts\n        on campaigns.account_id = accounts.account_id\n        and campaigns.source_relation = accounts.source_relation\n    group by 1,2,3,4,5,6,7,8,9,10\n)\n\nselect *\nfrom fields", "relation_name": "\"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__campaign_report\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.570530Z", "completed_at": "2023-12-12T20:41:58.582297Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.584748Z", "completed_at": "2023-12-12T20:41:58.584756Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.018400907516479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.dbt_utils_unique_combination_of_columns_stg_google_ads__campaign_stats_source_relation__campaign_id__ad_network_type__device__date_day.fea3ecfe6f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, ad_network_type, device, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_stats\"\n    group by source_relation, campaign_id, ad_network_type, device, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.578671Z", "completed_at": "2023-12-12T20:41:58.583717Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.586488Z", "completed_at": "2023-12-12T20:41:58.586493Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0214841365814209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__campaign_stats_date_day.dc097fd76b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_stats\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.574509Z", "completed_at": "2023-12-12T20:41:58.583976Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.586805Z", "completed_at": "2023-12-12T20:41:58.586809Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022971153259277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads_source.not_null_stg_google_ads__campaign_stats_campaign_id.11587fa10f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads_source\".\"stg_google_ads__campaign_stats\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.587104Z", "completed_at": "2023-12-12T20:41:58.593507Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.598867Z", "completed_at": "2023-12-12T20:41:58.598875Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.023359298706054688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.dbt_utils_unique_combination_of_columns_google_ads__keyword_report_source_relation__ad_group_id__criterion_id__date_day.82605f3acd", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, ad_group_id, criterion_id, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__keyword_report\"\n    group by source_relation, ad_group_id, criterion_id, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.595098Z", "completed_at": "2023-12-12T20:41:58.607015Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.608684Z", "completed_at": "2023-12-12T20:41:58.608691Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.017313003540039062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.not_null_google_ads__keyword_report_criterion_id.4cab66a055", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect criterion_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__keyword_report\"\nwhere criterion_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.602734Z", "completed_at": "2023-12-12T20:41:58.609069Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.610811Z", "completed_at": "2023-12-12T20:41:58.610815Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017069101333618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.not_null_google_ads__campaign_report_campaign_id.cc6694fa0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__campaign_report\"\nwhere campaign_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2023-12-12T20:41:58.599231Z", "completed_at": "2023-12-12T20:41:58.609936Z"}, {"name": "execute", "started_at": "2023-12-12T20:41:58.611096Z", "completed_at": "2023-12-12T20:41:58.611099Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.01796412467956543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.google_ads.dbt_utils_unique_combination_of_columns_google_ads__campaign_report_source_relation__campaign_id__advertising_channel_type__advertising_channel_subtype__date_day.29077cbd5e", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        source_relation, campaign_id, advertising_channel_type, advertising_channel_subtype, date_day\n    from \"postgres\".\"google_ads_integration_tests_31_google_ads\".\"google_ads__campaign_report\"\n    group by source_relation, campaign_id, advertising_channel_type, advertising_channel_subtype, date_day\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}], "elapsed_time": 2.2657127380371094, "args": {"print": true, "profiles_dir": "/Users/joseph.markiewicz/.dbt", "introspect": true, "populate_cache": true, "target": "postgres", "use_colors": true, "invocation_command": "dbt docs generate -t postgres", "select": [], "printer_width": 80, "version_check": true, "warn_error_options": {"include": [], "exclude": []}, "partial_parse_file_diff": true, "defer": false, "write_json": true, "static_parser": true, "vars": {}, "empty_catalog": false, "log_format_file": "debug", "exclude": [], "send_anonymous_usage_stats": true, "static": false, "compile": true, "log_path": "/Users/joseph.markiewicz/Documents/dbt_packages/ad_reporting/google/dbt_google_ads/integration_tests/logs", "project_dir": "/Users/joseph.markiewicz/Documents/dbt_packages/ad_reporting/google/dbt_google_ads/integration_tests", "indirect_selection": "eager", "show_resource_report": false, "use_colors_file": true, "strict_mode": false, "macro_debugging": false, "partial_parse": true, "favor_state": false, "log_level": "info", "cache_selected_only": false, "enable_legacy_logger": false, "log_level_file": "debug", "which": "generate", "log_format": "default", "quiet": false, "log_file_max_bytes": 10485760}}